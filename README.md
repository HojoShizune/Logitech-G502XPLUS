# Logitech G502X PLUS Lua 脚本集合

本项目包含了针对 Logitech G502X PLUS 鼠标的三种不同的 Lua 脚本，用于实现快速的复制、粘贴和删除操作。每种脚本都有不同的触发方式，适用于不同的使用场景。

## 项目结构

```
├── Click-Count Copy–Paste–Delete/     # 基于点击次数的操作脚本
│   └── index.lua
├── Duration-Based Copy–Paste–Delete/  # 基于按键持续时间的操作脚本
│   └── index.lua
├── Mode-Cycle Copy–Paste–Delete/      # 基于模式切换的操作脚本
│   └── index.lua
└── README.md                          # 本文档
```

## 脚本功能介绍

### 1. Click-Count Copy–Paste–Delete（点击次数模式）

**功能**：通过左键点击次数来决定执行的操作
- **单击**：粘贴 (Ctrl+V)
- **双击**：复制 (Ctrl+C)
- **三击及以上**：删除 (Delete)

**特性**：
- 时间窗口：300ms 内累计点击次数
- 适用于需要快速连续操作的场景
- 避免了复杂的按键组合

**使用场景**：文档编辑、快速文本处理

### 2. Duration-Based Copy–Paste–Delete（持续时间模式）

**功能**：通过左键按下的持续时间来决定执行的操作
- **短按**（<200ms）：粘贴 (Ctrl+V)
- **中按**（200ms-3000ms）：复制 (Ctrl+C)
- **长按**（≥3000ms）：删除 (Delete)

**特性**：
- 短按：200ms 以下
- 长按：3000ms 以上
- 包含防抖处理（20ms延迟）
- 更加直观的操作方式

**使用场景**：精确控制操作、避免误触发

### 3. Mode-Cycle Copy–Paste–Delete（模式切换）

**功能**：使用 G4 侧键切换模式，左键执行当前模式的操作
- **模式1**：复制 (Ctrl+C)
- **模式2**：粘贴 (Ctrl+V)
- **模式3**：删除 (Delete)

**操作方式**：
- **G4 键**：切换模式（循环：复制→粘贴→删除→复制...）
- **左键**：执行当前模式的操作

**特性**：
- 明确的模式切换
- 可扩展支持 G5 键（修改代码中的 `arg == 4` 为 `arg == 5`）
- 预留了声音和灯光提示接口

**使用场景**：需要重复执行同一操作、模式化工作流程

## 安装和使用

### 前置要求

- Logitech G502X PLUS 鼠标
- Logitech G HUB 软件
- 支持 Lua 脚本的固件版本

### 安装步骤

1. 打开 Logitech G HUB 软件
2. 选择您的 G502X PLUS 鼠标
3. 进入"脚本"或"宏"设置页面
4. 选择您需要的脚本类型对应的文件夹
5. 复制 `index.lua` 文件的内容到 G HUB 的脚本编辑器中
6. 保存并启用脚本

### 选择合适的脚本

| 脚本类型 | 优点 | 缺点 | 适用场景 |
|---------|------|------|----------|
| 点击次数模式 | 操作快速，学习成本低 | 可能误触发，需要等待时间窗口 | 快速文本编辑 |
| 持续时间模式 | 操作精确，误触发率低 | 需要掌握按键时间，长按较累 | 精确操作场景 |
| 模式切换 | 操作明确，支持重复操作 | 需要额外按键切换模式 | 重复性工作 |

## 自定义配置

### 调整时间参数

各脚本都包含可调整的时间参数：

**Click-Count 脚本**：
```lua
local CLICK_WINDOW = 300  -- 修改点击时间窗口（毫秒）
```

**Duration-Based 脚本**：
```lua
local SHORT_MS = 200      -- 修改短按时间阈值
local LONG_MS  = 3000     -- 修改长按时间阈值
```

### 修改按键映射

您可以根据需要修改脚本中的按键映射：
```lua
PressAndReleaseKey("lctrl", "c")    -- 复制
PressAndReleaseKey("lctrl", "v")    -- 粘贴
PressAndReleaseKey("delete")        -- 删除
```

### 添加反馈效果

Mode-Cycle 脚本预留了声音和灯光反馈接口：
```lua
-- 取消注释以启用声音提示
-- PlaySound("SwitchMode.wav")

-- 取消注释以启用灯光提示
-- SetLightColor(0, 255 * (mode==2 and 1 or 0), 255 * (mode==3 and 1 or 0))
```

## 注意事项

1. **兼容性**：确保您的 G502X PLUS 支持 Lua 脚本功能
2. **冲突**：同时只能启用一个脚本，避免功能冲突
3. **测试**：在重要文档上使用前，请先在测试环境中验证脚本功能
4. **备份**：建议在使用脚本前备份重要数据
5. **性能**：脚本可能会轻微影响鼠标响应速度

## 故障排除

### 常见问题

1. **脚本不工作**
   - 检查 G HUB 是否正确识别鼠标
   - 确认脚本已正确保存并启用
   - 重启 G HUB 软件

2. **操作延迟**
   - 检查时间参数设置是否合理
   - 确认系统性能是否足够

3. **误触发**
   - 调整时间阈值参数
   - 选择更适合您使用习惯的脚本类型

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这些脚本。

## 许可证

本项目遵循 MIT 许可证。

## 更新日志

- **2025-08-04**：初始版本发布，包含三种不同的操作模式

---

**作者**：[您的用户名]  
**最后更新**：2025年8月4日
